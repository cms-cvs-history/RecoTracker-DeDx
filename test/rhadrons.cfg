process dedx = {

#include "RecoTracker/DeDx/test/minbias.cfi"
#include "RecoTracker/DeDx/test/jets.cfi"
#include "RecoTracker/DeDx/test/rhadrons.cfi"
#replace PoolSource.maxEvents = 10
  source = PoolSource {

   untracked vstring fileNames = {
//'file:/home/bilibao/CMSSW/CMSSW_1_5_0_pre2/src/RecoBTag/TrackCounting/test/Reco.root'
//'file:/tmp/btag.root'
//'file:/home/bilibao/CMSSW/dedx/CMSSW_1_5_0_pre5/src/SimG4Core/CustomPhysics/test/digi.root'
  'file:/data/arizzi/CMSSW_1_6_0_pre8/src/SUSYBSMAnalysis/CSA07Skims/test/hscpHighPtMuonSkim_test.root' 
 }

 }
 untracked PSet maxEvents = {untracked int32 input = 50}


# tracker geometry
include "Geometry/TrackerGeometryBuilder/data/trackerGeometry.cfi"
 
# tracker numbering
#include "Geometry/TrackerNumberingBuilder/data/trackerNumberingGeometry.cfi"

#Refitter (+ access to Trajectory)

   # Track Associators
    include "SimTracker/TrackAssociation/data/TrackAssociatorByChi2.cfi"
    include "SimTracker/TrackAssociation/data/TrackAssociatorByHits.cfi"

include "Configuration/StandardSequences/data/Reconstruction.cff"
include "Configuration/StandardSequences/data/Simulation.cff"
include "Configuration/StandardSequences/data/MixingNoPileUp.cff"

include "Configuration/StandardSequences/data/VtxSmearedGauss.cff"

include "Configuration/ReleaseValidation/data/Services.cfi"
    include "Configuration/StandardSequences/data/FakeConditions.cff"

replace genParticleCandidates.abortOnUnknownPDGCode = false
include "RecoTracker/DeDx/data/dedxEstimators.cff"
include "RecoTracker/DeDx/data/dedxHitsFromCTF.cfi"

	

    module out = PoolOutputModule {
        untracked string fileName = '/tmp/arizzi/test.root'
    }


include "RecoTracker/TrackProducer/data/RefitterWithMaterial.cff"
replace TrackRefitter.TrajectoryInEvent = true

include "RecoTracker/DeDx/data/dedxHitsFromRefitter.cfi"

include  "RecoTracker/DeDx/data/dedxTruncated40.cfi"
replace dedxTruncated40.trackDeDxHits = dedxHitsFromRefitter

    path p3 = {TrackRefitter & dedxHitsFromRefitter & dedxTruncated40} # reconstruction
#   path p = {reconstruction, dedxHitsFromCTF, dedxHarmonic2, dedxTruncated40, dedxMedian}
   endpath outpath = { out }
 #  schedule = {p3,p4,outpath}

}
